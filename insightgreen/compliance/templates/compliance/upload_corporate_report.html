{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="content">


    {% if messages %}
    <div class="messages">
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-icon-start alert-dismissible fade show">
                <span class="alert-icon bg-{{ message.tags }} text-white">
                    <i class="ph-bell-ringing"></i>
                </span>
                <span class="fw-semibold">{{ message }}</span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        {% endfor %}
    </div>
{% endif %}





    <div class="row">
        <!-- ESG Compliance Form -->
<div class="col-lg-8">
    <div class="card">
        <div class="card-header">
            <h5 class="mb-0">ESG Corporate Report Submission</h5>
        </div>

        <div class="card-body">
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}

                {{ form.as_p }}

                <div class="card-footer d-flex justify-content-end p-0 pt-3">
                    <button type="submit" class="btn btn-primary">
                        Submit Corporate Report <i class="ph-paper-plane-tilt ms-2"></i>
                    </button>
                </div>
            
                
            </form>
            
        </div>
    </div>
</div>
<!-- /ESG Compliance Form -->


        <!-- Document Preview -->
<div class="col-lg-4">
    <div class="card">
        <div class="card-header">
            <h5 class="mb-0">ESG Standard Document Preview</h5>
        </div>
        <div class="card-body">
            <p class="text-muted">Uploaded document preview will appear here. You can review the contents before final submission.</p>
            <div class="border p-3">
                <!-- Initially show this message if no file is uploaded -->
                <p class="text-center text-muted mb-0" id="preview-message">No document uploaded yet. Please attach a report to see the preview.</p>

                <!-- Document Preview Area -->
                <div id="document-preview" class="text-center">
                    <!-- Here the preview will be inserted dynamically based on the file type -->
                </div>
            </div>
        </div>
    </div>
</div>
<!-- /Document Preview -->

<script>
    // Preview document on file selection
    document.getElementById('report_file').addEventListener('change', function(e) {
        var file = e.target.files[0];
        var previewArea = document.getElementById('document-preview');
        var messageArea = document.getElementById('preview-message');
        
        if (file) {
            messageArea.style.display = 'none';  // Hide the 'no file uploaded' message

            var fileReader = new FileReader();
            
            // If file is an image (e.g., PNG, JPEG, etc.)
            if (file.type.startsWith('image/')) {
                fileReader.onload = function(event) {
                    var img = document.createElement('img');
                    img.src = event.target.result;
                    img.style.maxWidth = '100%';
                    img.style.maxHeight = '800px';
                    previewArea.innerHTML = '';  // Clear the previous preview
                    previewArea.appendChild(img);
                };
            }
            // If file is a PDF
            else if (file.type === 'application/pdf') {
                fileReader.onload = function(event) {
                    var pdfEmbed = document.createElement('embed');
                    pdfEmbed.src = event.target.result;
                    pdfEmbed.width = '100%';
                    pdfEmbed.height = '1000px';
                    pdfEmbed.type = 'application/pdf';
                    previewArea.innerHTML = '';  // Clear the previous preview
                    previewArea.appendChild(pdfEmbed);
                };
            }
            // Add more file types (e.g., Word, Excel) as needed

            fileReader.readAsDataURL(file);  // Read the file content as data URL
        } else {
            messageArea.style.display = 'block';  // Show the 'no file uploaded' message
            previewArea.innerHTML = '';  // Clear the preview area
        }
    });
</script>

    </div>
</div>

{% endblock %}













